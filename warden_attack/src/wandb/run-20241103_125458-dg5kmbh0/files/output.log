11/03/2024 12:55:01 - INFO - accelerate.tracking - Initialized WandB project embmarker
11/03/2024 12:55:01 - INFO - accelerate.tracking - Make sure to log any initial configurations with `self.store_init_configuration` before training!
11/03/2024 12:55:01 - INFO - accelerate.tracking - Stored initial configuration hyperparameters to WandB
11/03/2024 12:55:05 - INFO - __main__ - sample 588 examples with 0 triggers for visualization
11/03/2024 12:55:05 - INFO - __main__ - sample 11 examples with 1 triggers for visualization
11/03/2024 12:55:05 - INFO - __main__ - sample 1 examples with 2 triggers for visualization
11/03/2024 12:55:05 - INFO - __main__ - sample 1 examples with 3 triggers for visualization
11/03/2024 12:55:05 - INFO - __main__ - plot embeddings shape torch.Size([601, 1536]).
11/03/2024 12:55:06 - INFO - accelerate.tracking - Successfully logged to WandB
11/03/2024 12:55:07 - INFO - __main__ - ***** Running copier training *****
11/03/2024 12:55:07 - INFO - __main__ -   Num examples = 3502
11/03/2024 12:55:07 - INFO - __main__ -   Num Epochs = 20
11/03/2024 12:55:07 - INFO - __main__ -   Instantaneous batch size per device = 32
11/03/2024 12:55:07 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 32
11/03/2024 12:55:07 - INFO - __main__ -   Gradient Accumulation steps = 1
11/03/2024 12:55:07 - INFO - __main__ -   Total optimization steps = 2200





  5%|████▉                                                                                              | 110/2200 [00:11<03:23, 10.29it/s]11/03/2024 12:55:19 - INFO - __main__ - Target Embs shape: torch.Size([2, 1536])
11/03/2024 12:55:19 - INFO - __main__ - epoch 0: defaultdict(<class 'dict'>, {0: {'pvalue': 0.0335416594061465, 'trigger_cos_mean_0': 0.884030818939209, 'trigger_cos_std_0': 0.0005344923046945208, 'trigger_l2_mean_0': 0.23193855583667755, 'trigger_l2_std_0': 0.001069074660217844, 'trigger_cos_mean_all': 0.8834323883056641, 'trigger_cos_std_all': 0.0007822379222512413, 'trigger_l2_mean_all': 0.23313534259796143, 'trigger_l2_std_all': 0.0015645373603867057, 'delta_cos': -0.0005984306335449219, 'delta_l2': 0.0011967867612838745}, 'all': {'pvalue': 0.0002704973445409677, 'delta_cos': -0.000464022159576416, 'delta_l2': 0.0009281039237976074}, 1: {'pvalue': 0.0002704973445409677, 'trigger_cos_mean_0': 0.724633514881134, 'trigger_cos_std_0': 0.00033524096085631703, 'trigger_l2_mean_0': 0.5507331490516663, 'trigger_l2_std_0': 0.0006703541937988532, 'trigger_cos_mean_all': 0.7241694927215576, 'trigger_cos_std_all': 0.00019604843796981964, 'trigger_l2_mean_all': 0.5516612529754639, 'trigger_l2_std_all': 0.0003921867597045448, 'delta_cos': -0.000464022159576416, 'delta_l2': 0.0009281039237976074}}), train_loss: 0.00033727738667618145
11/03/2024 12:55:19 - INFO - accelerate.tracking - Successfully logged to WandB




 10%|█████████▊                                                                                         | 219/2200 [00:23<03:41,  8.96it/s]11/03/2024 12:55:30 - INFO - __main__ - Target Embs shape: torch.Size([2, 1536])
11/03/2024 12:55:30 - INFO - __main__ - epoch 1: defaultdict(<class 'dict'>, {0: {'pvalue': 0.17453300569806826, 'trigger_cos_mean_0': 0.8786203265190125, 'trigger_cos_std_0': 0.0006641242715721884, 'trigger_l2_mean_0': 0.24275951087474823, 'trigger_l2_std_0': 0.0013282208420606384, 'trigger_cos_mean_all': 0.8781083226203918, 'trigger_cos_std_all': 0.0009861919798921023, 'trigger_l2_mean_all': 0.2437835931777954, 'trigger_l2_std_all': 0.0019725759437001916, 'delta_cos': -0.0005120038986206055, 'delta_l2': 0.0010240823030471802}, 'all': {'pvalue': 0.00396729438660086, 'delta_cos': -0.0005055069923400879, 'delta_l2': 0.001010894775390625}, 1: {'pvalue': 0.00396729438660086, 'trigger_cos_mean_0': 0.7248879075050354, 'trigger_cos_std_0': 0.00040781351582139523, 'trigger_l2_mean_0': 0.5502244234085083, 'trigger_l2_std_0': 0.0008155825012676097, 'trigger_cos_mean_all': 0.7243824005126953, 'trigger_cos_std_all': 0.00037345485304488213, 'trigger_l2_mean_all': 0.5512353181838989, 'trigger_l2_std_all': 0.0007469535781897227, 'delta_cos': -0.0005055069923400879, 'delta_l2': 0.001010894775390625}}), train_loss: 0.00019640621136535297
11/03/2024 12:55:30 - INFO - accelerate.tracking - Successfully logged to WandB





 15%|██████████████▊                                                                                    | 330/2200 [00:34<03:01, 10.32it/s]11/03/2024 12:55:42 - INFO - __main__ - Target Embs shape: torch.Size([2, 1536])
11/03/2024 12:55:42 - INFO - __main__ - epoch 2: defaultdict(<class 'dict'>, {0: {'pvalue': 0.571336004933722, 'trigger_cos_mean_0': 0.8792069554328918, 'trigger_cos_std_0': 0.0015155539268113163, 'trigger_l2_mean_0': 0.2415863275527954, 'trigger_l2_std_0': 0.0030310383989701367, 'trigger_cos_mean_all': 0.8794072270393372, 'trigger_cos_std_all': 0.0012889170364352514, 'trigger_l2_mean_all': 0.2411857545375824, 'trigger_l2_std_all': 0.0025778297305997927, 'delta_cos': 0.0002002716064453125, 'delta_l2': -0.0004005730152130127}, 'all': {'pvalue': 0.33559098126008213, 'delta_cos': 0.0002002716064453125, 'delta_l2': -0.0004005730152130127}, 1: {'pvalue': 0.33559098126008213, 'trigger_cos_mean_0': 0.7263786792755127, 'trigger_cos_std_0': 0.0019690230319677608, 'trigger_l2_mean_0': 0.5472428202629089, 'trigger_l2_std_0': 0.003937930182233456, 'trigger_cos_mean_all': 0.7261338233947754, 'trigger_cos_std_all': 0.0015138214924263137, 'trigger_l2_mean_all': 0.5477324724197388, 'trigger_l2_std_all': 0.0030276541808975464, 'delta_cos': -0.0002448558807373047, 'delta_l2': 0.000489652156829834}}), train_loss: 0.00019402109425176273
11/03/2024 12:55:42 - INFO - accelerate.tracking - Successfully logged to WandB





 20%|███████████████████▊                                                                               | 439/2200 [00:46<02:49, 10.41it/s]11/03/2024 12:55:53 - INFO - __main__ - Target Embs shape: torch.Size([2, 1536])
11/03/2024 12:55:53 - INFO - __main__ - epoch 3: defaultdict(<class 'dict'>, {0: {'pvalue': 0.33559098126008213, 'trigger_cos_mean_0': 0.8704160451889038, 'trigger_cos_std_0': 0.003694664333544921, 'trigger_l2_mean_0': 0.25916793942451477, 'trigger_l2_std_0': 0.007389323905621677, 'trigger_cos_mean_all': 0.8716182708740234, 'trigger_cos_std_all': 0.0023856211019441234, 'trigger_l2_mean_all': 0.2567635774612427, 'trigger_l2_std_all': 0.004771154462176041, 'delta_cos': 0.001202225685119629, 'delta_l2': -0.0024043619632720947}, 'all': {'pvalue': 0.33559098126008213, 'delta_cos': 0.001202225685119629, 'delta_l2': -0.0024043619632720947}, 1: {'pvalue': 0.33559098126008213, 'trigger_cos_mean_0': 0.7226465344429016, 'trigger_cos_std_0': 0.0038010072724315716, 'trigger_l2_mean_0': 0.5547071099281311, 'trigger_l2_std_0': 0.007601994899675756, 'trigger_cos_mean_all': 0.7231845855712891, 'trigger_cos_std_all': 0.0032166020599476287, 'trigger_l2_mean_all': 0.5536309480667114, 'trigger_l2_std_all': 0.006433186692251187, 'delta_cos': 0.0005380511283874512, 'delta_l2': -0.0010761618614196777}}), train_loss: 0.00018757656216621398
11/03/2024 12:55:53 - INFO - accelerate.tracking - Successfully logged to WandB




 25%|████████████████████████▋                                                                          | 549/2200 [00:57<02:42, 10.19it/s]11/03/2024 12:56:05 - INFO - __main__ - Target Embs shape: torch.Size([2, 1536])
11/03/2024 12:56:05 - INFO - __main__ - epoch 4: defaultdict(<class 'dict'>, {0: {'pvalue': 0.17453300569806826, 'trigger_cos_mean_0': 0.8662314414978027, 'trigger_cos_std_0': 0.005963594094786232, 'trigger_l2_mean_0': 0.26753726601600647, 'trigger_l2_std_0': 0.011927140077870909, 'trigger_cos_mean_all': 0.8689910769462585, 'trigger_cos_std_all': 0.003164209658009134, 'trigger_l2_mean_all': 0.26201799511909485, 'trigger_l2_std_all': 0.0063285177614779056, 'delta_cos': 0.0027596354484558105, 'delta_l2': -0.005519270896911621}, 'all': {'pvalue': 0.0335416594061465, 'delta_cos': 0.0027596354484558105, 'delta_l2': -0.005519270896911621}, 1: {'pvalue': 0.0335416594061465, 'trigger_cos_mean_0': 0.7252254486083984, 'trigger_cos_std_0': 0.005175858713142227, 'trigger_l2_mean_0': 0.5495492815971375, 'trigger_l2_std_0': 0.010351698655326893, 'trigger_cos_mean_all': 0.7268329858779907, 'trigger_cos_std_all': 0.003972783128116778, 'trigger_l2_mean_all': 0.5463343262672424, 'trigger_l2_std_all': 0.007945468284757822, 'delta_cos': 0.0016075372695922852, 'delta_l2': -0.0032149553298950195}}), train_loss: 0.00018003290011124178
11/03/2024 12:56:05 - INFO - accelerate.tracking - Successfully logged to WandB





 30%|█████████████████████████████▋                                                                     | 660/2200 [01:09<02:15, 11.39it/s]11/03/2024 12:56:16 - INFO - __main__ - Target Embs shape: torch.Size([2, 1536])
11/03/2024 12:56:16 - INFO - __main__ - epoch 5: defaultdict(<class 'dict'>, {0: {'pvalue': 0.17453300569806826, 'trigger_cos_mean_0': 0.8666084408760071, 'trigger_cos_std_0': 0.0075110786796212395, 'trigger_l2_mean_0': 0.2667835056781769, 'trigger_l2_std_0': 0.015022218163650826, 'trigger_cos_mean_all': 0.8705569505691528, 'trigger_cos_std_all': 0.00400249082313365, 'trigger_l2_mean_all': 0.2588864266872406, 'trigger_l2_std_all': 0.008004995787996055, 'delta_cos': 0.003948509693145752, 'delta_l2': -0.00789707899093628}, 'all': {'pvalue': 0.012298612583953778, 'delta_cos': 0.003948509693145752, 'delta_l2': -0.00789707899093628}, 1: {'pvalue': 0.012298612583953778, 'trigger_cos_mean_0': 0.7216521501541138, 'trigger_cos_std_0': 0.005799686121255366, 'trigger_l2_mean_0': 0.556695818901062, 'trigger_l2_std_0': 0.011599387821979952, 'trigger_cos_mean_all': 0.7243568301200867, 'trigger_cos_std_all': 0.004581001221128252, 'trigger_l2_mean_all': 0.5512864589691162, 'trigger_l2_std_all': 0.00916187287569199, 'delta_cos': 0.0027046799659729004, 'delta_l2': -0.005409359931945801}}), train_loss: 0.00017504915595054627
11/03/2024 12:56:16 - INFO - accelerate.tracking - Successfully logged to WandB





 35%|██████████████████████████████████▋                                                                | 770/2200 [01:20<02:11, 10.84it/s]11/03/2024 12:56:28 - INFO - __main__ - Target Embs shape: torch.Size([2, 1536])
11/03/2024 12:56:28 - INFO - __main__ - epoch 6: defaultdict(<class 'dict'>, {0: {'pvalue': 0.08105771161340149, 'trigger_cos_mean_0': 0.8626348376274109, 'trigger_cos_std_0': 0.007795666129153384, 'trigger_l2_mean_0': 0.2747303545475006, 'trigger_l2_std_0': 0.015591232786849532, 'trigger_cos_mean_all': 0.8666107058525085, 'trigger_cos_std_all': 0.004519299528184394, 'trigger_l2_mean_all': 0.26677876710891724, 'trigger_l2_std_all': 0.009038515653488156, 'delta_cos': 0.003975868225097656, 'delta_l2': -0.007951587438583374}, 'all': {'pvalue': 0.012298612583953778, 'delta_cos': 0.003975868225097656, 'delta_l2': -0.007951587438583374}, 1: {'pvalue': 0.012298612583953778, 'trigger_cos_mean_0': 0.7219330072402954, 'trigger_cos_std_0': 0.005745675685651419, 'trigger_l2_mean_0': 0.556134045124054, 'trigger_l2_std_0': 0.011491302169847277, 'trigger_cos_mean_all': 0.7253431677818298, 'trigger_cos_std_all': 0.0050579849245610525, 'trigger_l2_mean_all': 0.5493137836456299, 'trigger_l2_std_all': 0.010116049908129464, 'delta_cos': 0.003410160541534424, 'delta_l2': -0.006820261478424072}}), train_loss: 0.00017157225784930315
11/03/2024 12:56:28 - INFO - accelerate.tracking - Successfully logged to WandB




 40%|███████████████████████████████████████▌                                                           | 879/2200 [01:32<02:28,  8.92it/s]11/03/2024 12:56:39 - INFO - __main__ - Target Embs shape: torch.Size([2, 1536])
11/03/2024 12:56:39 - INFO - __main__ - epoch 7: defaultdict(<class 'dict'>, {0: {'pvalue': 0.0335416594061465, 'trigger_cos_mean_0': 0.8626540303230286, 'trigger_cos_std_0': 0.007980751121920673, 'trigger_l2_mean_0': 0.2746920585632324, 'trigger_l2_std_0': 0.01596154749837198, 'trigger_cos_mean_all': 0.8667170405387878, 'trigger_cos_std_all': 0.004218208477721453, 'trigger_l2_mean_all': 0.2665662169456482, 'trigger_l2_std_all': 0.008436452332042892, 'delta_cos': 0.004063010215759277, 'delta_l2': -0.008125841617584229}, 'all': {'pvalue': 0.001115801546231492, 'delta_cos': 0.004644632339477539, 'delta_l2': -0.009289264678955078}, 1: {'pvalue': 0.001115801546231492, 'trigger_cos_mean_0': 0.7211794853210449, 'trigger_cos_std_0': 0.006009577389290971, 'trigger_l2_mean_0': 0.5576411485671997, 'trigger_l2_std_0': 0.012019198133949034, 'trigger_cos_mean_all': 0.7258241176605225, 'trigger_cos_std_all': 0.005372057121855041, 'trigger_l2_mean_all': 0.5483518838882446, 'trigger_l2_std_all': 0.010744095456265784, 'delta_cos': 0.004644632339477539, 'delta_l2': -0.009289264678955078}}), train_loss: 0.00016864099624482067
11/03/2024 12:56:39 - INFO - accelerate.tracking - Successfully logged to WandB





 45%|████████████████████████████████████████████▌                                                      | 989/2200 [01:43<01:52, 10.75it/s]11/03/2024 12:56:50 - INFO - __main__ - Target Embs shape: torch.Size([2, 1536])
11/03/2024 12:56:51 - INFO - __main__ - epoch 8: defaultdict(<class 'dict'>, {0: {'pvalue': 0.08105771161340149, 'trigger_cos_mean_0': 0.8624826669692993, 'trigger_cos_std_0': 0.008524021822361531, 'trigger_l2_mean_0': 0.2750348448753357, 'trigger_l2_std_0': 0.017048042467120415, 'trigger_cos_mean_all': 0.8668116331100464, 'trigger_cos_std_all': 0.004277044152109336, 'trigger_l2_mean_all': 0.26637688279151917, 'trigger_l2_std_all': 0.008554032864904535, 'delta_cos': 0.00432896614074707, 'delta_l2': -0.008657962083816528}, 'all': {'pvalue': 0.00396729438660086, 'delta_cos': 0.005134522914886475, 'delta_l2': -0.010269224643707275}, 1: {'pvalue': 0.00396729438660086, 'trigger_cos_mean_0': 0.7176274657249451, 'trigger_cos_std_0': 0.0065536634555383114, 'trigger_l2_mean_0': 0.5647452473640442, 'trigger_l2_std_0': 0.013107258853012952, 'trigger_cos_mean_all': 0.7227619886398315, 'trigger_cos_std_all': 0.0061669102793074975, 'trigger_l2_mean_all': 0.5544760227203369, 'trigger_l2_std_all': 0.012333830503658175, 'delta_cos': 0.005134522914886475, 'delta_l2': -0.010269224643707275}}), train_loss: 0.0001658696173266931
11/03/2024 12:56:51 - INFO - accelerate.tracking - Successfully logged to WandB





 50%|████████████████████████████████████████████████▉                                                 | 1099/2200 [01:55<01:45, 10.39it/s]11/03/2024 12:57:02 - INFO - __main__ - Target Embs shape: torch.Size([2, 1536])
11/03/2024 12:57:02 - INFO - __main__ - epoch 9: defaultdict(<class 'dict'>, {0: {'pvalue': 0.08105771161340149, 'trigger_cos_mean_0': 0.861000657081604, 'trigger_cos_std_0': 0.009012845401162622, 'trigger_l2_mean_0': 0.2779987156391144, 'trigger_l2_std_0': 0.01802569454653482, 'trigger_cos_mean_all': 0.8655438423156738, 'trigger_cos_std_all': 0.004128469152043009, 'trigger_l2_mean_all': 0.2689124345779419, 'trigger_l2_std_all': 0.008257000503195194, 'delta_cos': 0.004543185234069824, 'delta_l2': -0.009086281061172485}, 'all': {'pvalue': 0.012298612583953778, 'delta_cos': 0.005902111530303955, 'delta_l2': -0.01180410385131836}, 1: {'pvalue': 0.012298612583953778, 'trigger_cos_mean_0': 0.7182584404945374, 'trigger_cos_std_0': 0.007063701156411882, 'trigger_l2_mean_0': 0.5634831190109253, 'trigger_l2_std_0': 0.014127393899648275, 'trigger_cos_mean_all': 0.7241605520248413, 'trigger_cos_std_all': 0.006378444434929699, 'trigger_l2_mean_all': 0.5516790151596069, 'trigger_l2_std_all': 0.01275687336849418, 'delta_cos': 0.005902111530303955, 'delta_l2': -0.01180410385131836}}), train_loss: 0.00016332670030268754
11/03/2024 12:57:02 - INFO - accelerate.tracking - Successfully logged to WandB





 55%|█████████████████████████████████████████████████████▊                                            | 1209/2200 [02:06<01:42,  9.64it/s]11/03/2024 12:57:14 - INFO - __main__ - Target Embs shape: torch.Size([2, 1536])
11/03/2024 12:57:14 - INFO - __main__ - epoch 10: defaultdict(<class 'dict'>, {0: {'pvalue': 0.0335416594061465, 'trigger_cos_mean_0': 0.8599597215652466, 'trigger_cos_std_0': 0.009328593108562539, 'trigger_l2_mean_0': 0.2800808846950531, 'trigger_l2_std_0': 0.018657168408796124, 'trigger_cos_mean_all': 0.8643773198127747, 'trigger_cos_std_all': 0.004272531033718378, 'trigger_l2_mean_all': 0.27124544978141785, 'trigger_l2_std_all': 0.008544954396463517, 'delta_cos': 0.004417598247528076, 'delta_l2': -0.008835434913635254}, 'all': {'pvalue': 0.012298612583953778, 'delta_cos': 0.0064119696617126465, 'delta_l2': -0.012823939323425293}, 1: {'pvalue': 0.012298612583953778, 'trigger_cos_mean_0': 0.7177446484565735, 'trigger_cos_std_0': 0.007545417045269298, 'trigger_l2_mean_0': 0.5645109415054321, 'trigger_l2_std_0': 0.015090851634733555, 'trigger_cos_mean_all': 0.7241566181182861, 'trigger_cos_std_all': 0.006558055307153524, 'trigger_l2_mean_all': 0.5516870021820068, 'trigger_l2_std_all': 0.01311602345983004, 'delta_cos': 0.0064119696617126465, 'delta_l2': -0.012823939323425293}}), train_loss: 0.00016091237352652984
11/03/2024 12:57:14 - INFO - accelerate.tracking - Successfully logged to WandB




 60%|██████████████████████████████████████████████████████████▊                                       | 1319/2200 [02:18<01:35,  9.25it/s]11/03/2024 12:57:25 - INFO - __main__ - Target Embs shape: torch.Size([2, 1536])
11/03/2024 12:57:25 - INFO - __main__ - epoch 11: defaultdict(<class 'dict'>, {0: {'pvalue': 0.08105771161340149, 'trigger_cos_mean_0': 0.8613142967224121, 'trigger_cos_std_0': 0.009298731923841654, 'trigger_l2_mean_0': 0.277371346950531, 'trigger_l2_std_0': 0.01859737612329676, 'trigger_cos_mean_all': 0.8650649189949036, 'trigger_cos_std_all': 0.004384684279298224, 'trigger_l2_mean_all': 0.2698702812194824, 'trigger_l2_std_all': 0.008769253956280795, 'delta_cos': 0.003750622272491455, 'delta_l2': -0.007501065731048584}, 'all': {'pvalue': 0.00396729438660086, 'delta_cos': 0.00709766149520874, 'delta_l2': -0.014195263385772705}, 1: {'pvalue': 0.00396729438660086, 'trigger_cos_mean_0': 0.7209019064903259, 'trigger_cos_std_0': 0.007473598129362473, 'trigger_l2_mean_0': 0.5581963062286377, 'trigger_l2_std_0': 0.014947156704073084, 'trigger_cos_mean_all': 0.7279995679855347, 'trigger_cos_std_all': 0.007119854501664613, 'trigger_l2_mean_all': 0.544001042842865, 'trigger_l2_std_all': 0.014239724158502142, 'delta_cos': 0.00709766149520874, 'delta_l2': -0.014195263385772705}}), train_loss: 0.0001588082110339945
11/03/2024 12:57:25 - INFO - accelerate.tracking - Successfully logged to WandB





 65%|███████████████████████████████████████████████████████████████▋                                  | 1430/2200 [02:29<01:12, 10.60it/s]11/03/2024 12:57:36 - INFO - __main__ - Target Embs shape: torch.Size([2, 1536])
11/03/2024 12:57:37 - INFO - __main__ - epoch 12: defaultdict(<class 'dict'>, {0: {'pvalue': 0.08105771161340149, 'trigger_cos_mean_0': 0.8597396612167358, 'trigger_cos_std_0': 0.009219113950938763, 'trigger_l2_mean_0': 0.28052085638046265, 'trigger_l2_std_0': 0.018438183570591384, 'trigger_cos_mean_all': 0.8640201687812805, 'trigger_cos_std_all': 0.004615212113293725, 'trigger_l2_mean_all': 0.2719596326351166, 'trigger_l2_std_all': 0.009230356082480188, 'delta_cos': 0.004280507564544678, 'delta_l2': -0.00856122374534607}, 'all': {'pvalue': 0.00396729438660086, 'delta_cos': 0.007993519306182861, 'delta_l2': -0.015986979007720947}, 1: {'pvalue': 0.00396729438660086, 'trigger_cos_mean_0': 0.7181013822555542, 'trigger_cos_std_0': 0.007658327147163353, 'trigger_l2_mean_0': 0.5637973546981812, 'trigger_l2_std_0': 0.01531671702418127, 'trigger_cos_mean_all': 0.7260949015617371, 'trigger_cos_std_all': 0.007524744451815066, 'trigger_l2_mean_all': 0.5478103756904602, 'trigger_l2_std_all': 0.015049577677504922, 'delta_cos': 0.007993519306182861, 'delta_l2': -0.015986979007720947}}), train_loss: 0.00015691185200756246
11/03/2024 12:57:37 - INFO - accelerate.tracking - Successfully logged to WandB





 70%|████████████████████████████████████████████████████████████████████▌                             | 1539/2200 [02:41<01:11,  9.22it/s]11/03/2024 12:57:48 - INFO - __main__ - Target Embs shape: torch.Size([2, 1536])
11/03/2024 12:57:48 - INFO - __main__ - epoch 13: defaultdict(<class 'dict'>, {0: {'pvalue': 0.08105771161340149, 'trigger_cos_mean_0': 0.8606762886047363, 'trigger_cos_std_0': 0.009439570310128513, 'trigger_l2_mean_0': 0.27864769101142883, 'trigger_l2_std_0': 0.01887909202746317, 'trigger_cos_mean_all': 0.8648552894592285, 'trigger_cos_std_all': 0.004437776644677506, 'trigger_l2_mean_all': 0.2702898383140564, 'trigger_l2_std_all': 0.008875548304074197, 'delta_cos': 0.0041790008544921875, 'delta_l2': -0.008357852697372437}, 'all': {'pvalue': 0.00396729438660086, 'delta_cos': 0.008149504661560059, 'delta_l2': -0.016298770904541016}, 1: {'pvalue': 0.00396729438660086, 'trigger_cos_mean_0': 0.7161735892295837, 'trigger_cos_std_0': 0.007706519028382577, 'trigger_l2_mean_0': 0.5676528811454773, 'trigger_l2_std_0': 0.015413027661544941, 'trigger_cos_mean_all': 0.7243230938911438, 'trigger_cos_std_all': 0.007986711051605614, 'trigger_l2_mean_all': 0.5513541102409363, 'trigger_l2_std_all': 0.015973384545912097, 'delta_cos': 0.008149504661560059, 'delta_l2': -0.016298770904541016}}), train_loss: 0.0001552565869959918
11/03/2024 12:57:48 - INFO - accelerate.tracking - Successfully logged to WandB





 75%|█████████████████████████████████████████████████████████████████████████▍                        | 1649/2200 [02:52<01:00,  9.06it/s]11/03/2024 12:58:00 - INFO - __main__ - Target Embs shape: torch.Size([2, 1536])
11/03/2024 12:58:00 - INFO - __main__ - epoch 14: defaultdict(<class 'dict'>, {0: {'pvalue': 0.08105771161340149, 'trigger_cos_mean_0': 0.8585530519485474, 'trigger_cos_std_0': 0.009341492935089365, 'trigger_l2_mean_0': 0.28289419412612915, 'trigger_l2_std_0': 0.018682995917810044, 'trigger_cos_mean_all': 0.8623429536819458, 'trigger_cos_std_all': 0.004713103518439737, 'trigger_l2_mean_all': 0.27531445026397705, 'trigger_l2_std_all': 0.009426176346023146, 'delta_cos': 0.0037899017333984375, 'delta_l2': -0.0075797438621521}, 'all': {'pvalue': 0.00396729438660086, 'delta_cos': 0.008739709854125977, 'delta_l2': -0.01747959852218628}, 1: {'pvalue': 0.00396729438660086, 'trigger_cos_mean_0': 0.7164071798324585, 'trigger_cos_std_0': 0.007836701645042212, 'trigger_l2_mean_0': 0.5671858787536621, 'trigger_l2_std_0': 0.01567340196763511, 'trigger_cos_mean_all': 0.7251468896865845, 'trigger_cos_std_all': 0.008260928080916803, 'trigger_l2_mean_all': 0.5497062802314758, 'trigger_l2_std_all': 0.016521868696662945, 'delta_cos': 0.008739709854125977, 'delta_l2': -0.01747959852218628}}), train_loss: 0.0001538357443430207
11/03/2024 12:58:00 - INFO - accelerate.tracking - Successfully logged to WandB




 80%|██████████████████████████████████████████████████████████████████████████████▍                   | 1760/2200 [03:04<00:40, 10.99it/s]11/03/2024 12:58:11 - INFO - __main__ - Target Embs shape: torch.Size([2, 1536])
11/03/2024 12:58:11 - INFO - __main__ - epoch 15: defaultdict(<class 'dict'>, {0: {'pvalue': 0.08105771161340149, 'trigger_cos_mean_0': 0.8590511083602905, 'trigger_cos_std_0': 0.009577775846022468, 'trigger_l2_mean_0': 0.28189796209335327, 'trigger_l2_std_0': 0.019155534620975, 'trigger_cos_mean_all': 0.8631213307380676, 'trigger_cos_std_all': 0.004724565932337759, 'trigger_l2_mean_all': 0.27375760674476624, 'trigger_l2_std_all': 0.00944899773562439, 'delta_cos': 0.0040702223777771, 'delta_l2': -0.008140355348587036}, 'all': {'pvalue': 0.001115801546231492, 'delta_cos': 0.008935332298278809, 'delta_l2': -0.017870604991912842}, 1: {'pvalue': 0.001115801546231492, 'trigger_cos_mean_0': 0.715945303440094, 'trigger_cos_std_0': 0.008105034790914145, 'trigger_l2_mean_0': 0.5681095719337463, 'trigger_l2_std_0': 0.01620999534910688, 'trigger_cos_mean_all': 0.7248806357383728, 'trigger_cos_std_all': 0.008513020039103331, 'trigger_l2_mean_all': 0.5502389669418335, 'trigger_l2_std_all': 0.01702607332739026, 'delta_cos': 0.008935332298278809, 'delta_l2': -0.017870604991912842}}), train_loss: 0.00015261330726471816
11/03/2024 12:58:11 - INFO - accelerate.tracking - Successfully logged to WandB





 85%|███████████████████████████████████████████████████████████████████████████████████▎              | 1869/2200 [03:15<00:35,  9.44it/s]11/03/2024 12:58:22 - INFO - __main__ - Target Embs shape: torch.Size([2, 1536])
11/03/2024 12:58:23 - INFO - __main__ - epoch 16: defaultdict(<class 'dict'>, {0: {'pvalue': 0.08105771161340149, 'trigger_cos_mean_0': 0.8598297238349915, 'trigger_cos_std_0': 0.009275222895653482, 'trigger_l2_mean_0': 0.2803408205509186, 'trigger_l2_std_0': 0.018550543410226324, 'trigger_cos_mean_all': 0.8634630441665649, 'trigger_cos_std_all': 0.004598664983500497, 'trigger_l2_mean_all': 0.2730741500854492, 'trigger_l2_std_all': 0.009197192969845345, 'delta_cos': 0.0036333203315734863, 'delta_l2': -0.00726667046546936}, 'all': {'pvalue': 0.001115801546231492, 'delta_cos': 0.009270191192626953, 'delta_l2': -0.018540501594543457}, 1: {'pvalue': 0.001115801546231492, 'trigger_cos_mean_0': 0.7161535024642944, 'trigger_cos_std_0': 0.008129254833204844, 'trigger_l2_mean_0': 0.5676931142807007, 'trigger_l2_std_0': 0.016258543867176355, 'trigger_cos_mean_all': 0.7254236936569214, 'trigger_cos_std_all': 0.008534626318707246, 'trigger_l2_mean_all': 0.5491526126861572, 'trigger_l2_std_all': 0.017069140603526007, 'delta_cos': 0.009270191192626953, 'delta_l2': -0.018540501594543457}}), train_loss: 0.00015157318928024985
11/03/2024 12:58:23 - INFO - accelerate.tracking - Successfully logged to WandB





 90%|████████████████████████████████████████████████████████████████████████████████████████▏         | 1979/2200 [03:27<00:21, 10.46it/s]11/03/2024 12:58:34 - INFO - __main__ - Target Embs shape: torch.Size([2, 1536])
11/03/2024 12:58:34 - INFO - __main__ - epoch 17: defaultdict(<class 'dict'>, {0: {'pvalue': 0.08105771161340149, 'trigger_cos_mean_0': 0.8594123125076294, 'trigger_cos_std_0': 0.009440007256287632, 'trigger_l2_mean_0': 0.2811753451824188, 'trigger_l2_std_0': 0.018879921178862242, 'trigger_cos_mean_all': 0.8631890416145325, 'trigger_cos_std_all': 0.004708283760133011, 'trigger_l2_mean_all': 0.2736220061779022, 'trigger_l2_std_all': 0.009416614923611285, 'delta_cos': 0.003776729106903076, 'delta_l2': -0.0075533390045166016}, 'all': {'pvalue': 0.001115801546231492, 'delta_cos': 0.009779632091522217, 'delta_l2': -0.019559144973754883}, 1: {'pvalue': 0.001115801546231492, 'trigger_cos_mean_0': 0.715549111366272, 'trigger_cos_std_0': 0.008124620830890113, 'trigger_l2_mean_0': 0.5689018964767456, 'trigger_l2_std_0': 0.016249246209182, 'trigger_cos_mean_all': 0.7253287434577942, 'trigger_cos_std_all': 0.008707054628730015, 'trigger_l2_mean_all': 0.5493427515029907, 'trigger_l2_std_all': 0.01741398383036549, 'delta_cos': 0.009779632091522217, 'delta_l2': -0.019559144973754883}}), train_loss: 0.0001507944173433564
11/03/2024 12:58:34 - INFO - accelerate.tracking - Successfully logged to WandB





 95%|█████████████████████████████████████████████████████████████████████████████████████████████     | 2089/2200 [03:38<00:10, 10.25it/s]11/03/2024 12:58:45 - INFO - __main__ - Target Embs shape: torch.Size([2, 1536])
11/03/2024 12:58:46 - INFO - __main__ - epoch 18: defaultdict(<class 'dict'>, {0: {'pvalue': 0.08105771161340149, 'trigger_cos_mean_0': 0.8597132563591003, 'trigger_cos_std_0': 0.009346381660241224, 'trigger_l2_mean_0': 0.2805735170841217, 'trigger_l2_std_0': 0.01869278724436676, 'trigger_cos_mean_all': 0.863500714302063, 'trigger_cos_std_all': 0.004648141867760565, 'trigger_l2_mean_all': 0.27299878001213074, 'trigger_l2_std_all': 0.009296366077297055, 'delta_cos': 0.0037874579429626465, 'delta_l2': -0.007574737071990967}, 'all': {'pvalue': 0.001115801546231492, 'delta_cos': 0.00970613956451416, 'delta_l2': -0.01941227912902832}, 1: {'pvalue': 0.001115801546231492, 'trigger_cos_mean_0': 0.7166042327880859, 'trigger_cos_std_0': 0.008134052845256421, 'trigger_l2_mean_0': 0.5667917728424072, 'trigger_l2_std_0': 0.016267969485535366, 'trigger_cos_mean_all': 0.7263103723526001, 'trigger_cos_std_all': 0.008647564885581958, 'trigger_l2_mean_all': 0.5473794937133789, 'trigger_l2_std_all': 0.01729510787078602, 'delta_cos': 0.00970613956451416, 'delta_l2': -0.01941227912902832}}), train_loss: 0.00015020626173778014
11/03/2024 12:58:46 - INFO - accelerate.tracking - Successfully logged to WandB




100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 2200/2200 [03:50<00:00, 10.78it/s]11/03/2024 12:58:57 - INFO - __main__ - Target Embs shape: torch.Size([2, 1536])
11/03/2024 12:58:57 - INFO - __main__ - epoch 19: defaultdict(<class 'dict'>, {0: {'pvalue': 0.08105771161340149, 'trigger_cos_mean_0': 0.8594468832015991, 'trigger_cos_std_0': 0.009397590314072208, 'trigger_l2_mean_0': 0.2811063230037689, 'trigger_l2_std_0': 0.018795124522275688, 'trigger_cos_mean_all': 0.8632828593254089, 'trigger_cos_std_all': 0.004689404723932782, 'trigger_l2_mean_all': 0.27343446016311646, 'trigger_l2_std_all': 0.00937880607531164, 'delta_cos': 0.0038359761238098145, 'delta_l2': -0.007671862840652466}, 'all': {'pvalue': 0.001115801546231492, 'delta_cos': 0.00977015495300293, 'delta_l2': -0.01954030990600586}, 1: {'pvalue': 0.001115801546231492, 'trigger_cos_mean_0': 0.715955376625061, 'trigger_cos_std_0': 0.008202399624945941, 'trigger_l2_mean_0': 0.5680893659591675, 'trigger_l2_std_0': 0.016404800056012202, 'trigger_cos_mean_all': 0.725725531578064, 'trigger_cos_std_all': 0.008802318634210568, 'trigger_l2_mean_all': 0.5485490560531616, 'trigger_l2_std_all': 0.017604557956517254, 'delta_cos': 0.00977015495300293, 'delta_l2': -0.01954030990600586}}), train_loss: 0.00014980802820487455
11/03/2024 12:58:57 - INFO - accelerate.tracking - Successfully logged to WandB
100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 2200/2200 [03:51<00:00,  9.51it/s]
multi_watermark_run_gpt_backdoor.py:849: FutureWarning: load_metric is deprecated and will be removed in the next major version of datasets. Use 'evaluate.load' instead, from the new library 🤗 Evaluate: https://huggingface.co/docs/evaluate
  acc_metric = load_metric('accuracy', trust_remote_code=True)
11/03/2024 12:59:02 - INFO - __main__ - ***** Running classifier training *****
11/03/2024 12:59:02 - INFO - __main__ -   Num examples = 3502
11/03/2024 12:59:02 - INFO - __main__ -   Num Epochs = 20
11/03/2024 12:59:02 - INFO - __main__ -   Instantaneous batch size per device = 32
11/03/2024 12:59:02 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 32
11/03/2024 12:59:02 - INFO - __main__ -   Gradient Accumulation steps = 1
11/03/2024 12:59:02 - INFO - __main__ -   Total optimization steps = 4400

  2%|██▍                                                                                                | 106/4400 [00:03<02:15, 31.80it/s]11/03/2024 12:59:06 - INFO - __main__ - epoch 0: {'accuracy': 0.882, 'f1': 0.8819652412693331}
11/03/2024 12:59:06 - INFO - accelerate.tracking - Successfully logged to WandB

  5%|████▉                                                                                              | 219/4400 [00:07<02:07, 32.84it/s]11/03/2024 12:59:10 - INFO - __main__ - epoch 1: {'accuracy': 0.874, 'f1': 0.8734013226640268}
11/03/2024 12:59:10 - INFO - accelerate.tracking - Successfully logged to WandB

  7%|███████▎                                                                                           | 327/4400 [00:11<02:08, 31.81it/s]11/03/2024 12:59:14 - INFO - __main__ - epoch 2: {'accuracy': 0.884, 'f1': 0.882660912461229}
11/03/2024 12:59:14 - INFO - accelerate.tracking - Successfully logged to WandB

 10%|█████████▉                                                                                         | 439/4400 [00:15<01:58, 33.37it/s]11/03/2024 12:59:18 - INFO - __main__ - epoch 3: {'accuracy': 0.898, 'f1': 0.8983003543213474}
11/03/2024 12:59:18 - INFO - accelerate.tracking - Successfully logged to WandB

 12%|████████████▎                                                                                      | 547/4400 [00:19<02:01, 31.70it/s]11/03/2024 12:59:22 - INFO - __main__ - epoch 4: {'accuracy': 0.898, 'f1': 0.8982966755447721}
11/03/2024 12:59:22 - INFO - accelerate.tracking - Successfully logged to WandB

 15%|██████████████▊                                                                                    | 659/4400 [00:23<01:53, 32.98it/s]11/03/2024 12:59:26 - INFO - __main__ - epoch 5: {'accuracy': 0.886, 'f1': 0.8854164035464397}
11/03/2024 12:59:26 - INFO - accelerate.tracking - Successfully logged to WandB

 17%|█████████████████▎                                                                                 | 767/4400 [00:27<01:53, 31.95it/s]11/03/2024 12:59:30 - INFO - __main__ - epoch 6: {'accuracy': 0.888, 'f1': 0.8879492503348797}
11/03/2024 12:59:30 - INFO - accelerate.tracking - Successfully logged to WandB
 20%|███████████████████▊                                                                               | 879/4400 [00:31<01:45, 33.24it/s]
 21%|█████████████████████▏                                                                             | 939/4400 [00:33<01:48, 31.88it/s]11/03/2024 12:59:34 - INFO - __main__ - epoch 7: {'accuracy': 0.896, 'f1': 0.8962182947086935}
 22%|██████████████████████▏                                                                            | 987/4400 [00:35<01:46, 31.91it/s]11/03/2024 12:59:34 - INFO - __main__ - epoch 7: {'accuracy': 0.896, 'f1': 0.8962182947086935}
 24%|███████████████████████▍                                                                          | 1051/4400 [00:37<01:45, 31.89it/s]11/03/2024 12:59:38 - INFO - __main__ - epoch 8: {'accuracy': 0.904, 'f1': 0.9046759186351185}
11/03/2024 12:59:42 - INFO - accelerate.tracking - Successfully logged to WandB                        | 1099/4400 [00:39<01:38, 33.48it/s]11/03/2024 12:59:42 - INFO - __main__ - epoch 9: {'accuracy': 0.884, 'f1': 0.8837009611783253}
11/03/2024 12:59:42 - INFO - accelerate.tracking - Successfully logged to WandB                        | 1099/4400 [00:39<01:38, 33.48it/s]11/03/2024 12:59:42 - INFO - __main__ - epoch 9: {'accuracy': 0.884, 'f1': 0.8837009611783253}
 27%|██████████████████████████▉                                                                       | 1207/4400 [00:43<01:39, 32.13it/s]11/03/2024 12:59:46 - INFO - __main__ - epoch 10: {'accuracy': 0.89, 'f1': 0.8906919914488314}
11/03/2024 12:59:46 - INFO - accelerate.tracking - Successfully logged to WandB
 30%|█████████████████████████████▍                                                                    | 1319/4400 [00:47<01:31, 33.54it/s]11/03/2024 12:59:50 - INFO - __main__ - epoch 11: {'accuracy': 0.892, 'f1': 0.8925418200010666}
11/03/2024 12:59:50 - INFO - accelerate.tracking - Successfully logged to WandB
 32%|██████████████████████████████▉                                                                   | 1387/4400 [00:50<01:34, 31.89it/s]
 33%|███████████████████████████████▉                                                                  | 1435/4400 [00:52<02:56, 16.79it/s]11/03/2024 12:59:54 - INFO - __main__ - epoch 12: {'accuracy': 0.896, 'f1': 0.8966503025933941}
 34%|█████████████████████████████████▍                                                                | 1499/4400 [00:54<01:30, 31.95it/s]11/03/2024 12:59:54 - INFO - __main__ - epoch 12: {'accuracy': 0.896, 'f1': 0.8966503025933941}
 35%|██████████████████████████████████▍                                                               | 1547/4400 [00:56<02:49, 16.82it/s]11/03/2024 12:59:58 - INFO - __main__ - epoch 13: {'accuracy': 0.89, 'f1': 0.8907199730106726}}
 37%|███████████████████████████████████▉                                                              | 1611/4400 [00:58<01:27, 32.02it/s]11/03/2024 12:59:58 - INFO - __main__ - epoch 13: {'accuracy': 0.89, 'f1': 0.8907199730106726}}
 38%|████████████████████████████████████▉                                                             | 1659/4400 [01:00<02:19, 19.58it/s]11/03/2024 13:00:02 - INFO - __main__ - epoch 14: {'accuracy': 0.89, 'f1': 0.8906594256472907}}
 39%|██████████████████████████████████████▍                                                           | 1723/4400 [01:02<01:23, 31.96it/s]11/03/2024 13:00:02 - INFO - __main__ - epoch 14: {'accuracy': 0.89, 'f1': 0.8906594256472907}}
 40%|███████████████████████████████████████▍                                                          | 1771/4400 [01:04<02:14, 19.49it/s]11/03/2024 13:00:06 - INFO - __main__ - epoch 15: {'accuracy': 0.89, 'f1': 0.8906594256472907}}
 42%|████████████████████████████████████████▊                                                         | 1835/4400 [01:06<01:19, 32.20it/s]11/03/2024 13:00:06 - INFO - __main__ - epoch 15: {'accuracy': 0.89, 'f1': 0.8906594256472907}}
 43%|█████████████████████████████████████████▉                                                        | 1883/4400 [01:08<01:53, 22.20it/s]11/03/2024 13:00:10 - INFO - __main__ - epoch 16: {'accuracy': 0.89, 'f1': 0.8906594256472907}}
 44%|███████████████████████████████████████████▎                                                      | 1947/4400 [01:10<01:16, 32.11it/s]11/03/2024 13:00:10 - INFO - __main__ - epoch 16: {'accuracy': 0.89, 'f1': 0.8906594256472907}}
 45%|████████████████████████████████████████████▍                                                     | 1995/4400 [01:12<01:48, 22.12it/s]11/03/2024 13:00:14 - INFO - __main__ - epoch 17: {'accuracy': 0.89, 'f1': 0.8906594256472907}}
 46%|█████████████████████████████████████████████▌                                                    | 2043/4400 [01:13<01:13, 31.92it/s]11/03/2024 13:00:14 - INFO - __main__ - epoch 17: {'accuracy': 0.89, 'f1': 0.8906594256472907}}
 48%|██████████████████████████████████████████████▌                                                   | 2091/4400 [01:15<02:44, 14.01it/s]11/03/2024 13:00:18 - INFO - __main__ - epoch 18: {'accuracy': 0.892, 'f1': 0.8927235725004536}
 49%|███████████████████████████████████████████████▉                                                  | 2155/4400 [01:17<01:10, 32.04it/s]11/03/2024 13:00:18 - INFO - __main__ - epoch 18: {'accuracy': 0.892, 'f1': 0.8927235725004536}
 50%|█████████████████████████████████████████████████                                                 | 2200/4400 [01:19<01:19, 27.60it/s]11/03/2024 13:00:22 - INFO - __main__ - epoch 19: {'accuracy': 0.89, 'f1': 0.8906594256472907}}
 50%|█████████████████████████████████████████████████                                                 | 2200/4400 [01:19<01:19, 27.60it/s]11/03/2024 13:00:22 - INFO - __main__ - epoch 19: {'accuracy': 0.89, 'f1': 0.8906594256472907}}